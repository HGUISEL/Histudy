{% extends "base_template.html" %}
{% block content %}

<div class="container">
<h4>스터디그룹 현황
    <a style="float:right;" href="{% url 'top3' %}" class="btn btn-outline-primary">TOP 3</a>
    <a style="float:right;" href="{% url 'grid' %}" class="btn btn-outline-primary">GRID</a>
</h4>

<form
    method="POST"
    action=""
    enctype="multipart/form-data"
    id="dataform"
    class="form-inline"
>
    {% csrf_token %}

    <span>
		<h6>연도</h6>
        <select name="year" id="year">
            <option val="None">None</option>
            <option val="2020"> 2020 </option>
            <option val="2021"> 2021 </option>
            <option val="2022"> 2022 </option>
        </select>
	</span>

    {% if chosen_year %}
    <script type="text/javascript">
      document.getElementById('year').value = "{{chosen_year}}";
    </script>
    {% else %}
    <script type="text/javascript">
      document.getElementById('year').value = "None";
    </script>
    {% endif %}

    <span>
		<h6>학기</h6>
        <select name="sem" id="sem">
            <option val="None">None</option>
            <option val="1"> 1 </option>
            <option val="2"> 2 </option>
        </select>
	</span>


    {% if chosen_sem %}
    <script type="text/javascript">
      document.getElementById('sem').value = "{{chosen_sem}}";
    </script>
    {% else %}
    <script type="text/javascript">
      document.getElementById('sem').value = "None";
    </script>
    {% endif %}


    <input type="submit" value="Filter" />
</form>

<br>

    <table class="table table-inbox table-hover" style="font-size:12px; width:100%;">
        <tr>
            <th></th>
            <th>group</th>
            <th>posts</th>
            <th>most recent</th>
            <th>누적 공부 시간(분)</th>
            <th></th>
        </tr>
    {% for user in list %}
        {% if not user.is_staff %}
        <tr>
            <td>
                {{ forloop.counter }}
            </td>
            <td>
                <a href="{% url 'list' user.username %}">
                {% if user.num_posts > 9 %}
                <font color="green">
                {{ user.username }}
                </font>
                {% else %}
                {{ user.username }}
                {% endif %}
                </a>
            </td>
            <td>{{ user.num_posts }}</td>
            <td>{{ user.recent }}</td>
            <td>{{ user.total_dur }}</td>
            <td><a class="confirm-delete" href="{% url 'confirm_delete_user' user.pk %}">유저삭제</a></td>
        {% endif %}
    {% endfor %}
    </tbody>
    </table>
</div>

<script>
    $(document).on('click', '.confirm-delete', function(){
    return confirm('유저를 삭제하시겠습니까?');
    })
</script>

{% endblock %}

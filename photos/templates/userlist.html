{% extends "base_template.html" %}

{% block style %}
{% load static %}

{% endblock %}

{% block content %}

<div class="container">
<h4>스터디그룹 현황
    <a style="float:right;" href="{% url 'top3' %}" class="btn btn-outline-secondary">TOP 3</a>
    <a style="float:right;" href="{% url 'grid' %}" class="btn btn-outline-secondary">GRID</a>
</h4>

<div>
    <form
        method="POST"
        action=""
        enctype="multipart/form-data"
        id="dataform"
        class="form-inline"
    >
        {% csrf_token %}

        <div>
            <select name="year" id="year" class="custom-select">
                {% for year in years %}
                <option val={{ year.year }}> {{ year.year }} </option>
                {% endfor %}
            </select>
        </div>

        {% if chosen_year %}
        <script type="text/javascript">
          document.getElementById('year').value = "{{chosen_year}}";
        </script>
        {% else %}
        <script type="text/javascript">
          document.getElementById('year').value = "{{year}}";
        </script>
        {% endif %}

        <div>
            <select name="sem" id="sem" class="custom-select">
                <option val="1"> 1 </option>
                <option val="2"> 2 </option>
            </select>
        </div>

        {% if chosen_sem %}
        <script type="text/javascript">
          document.getElementById('sem').value = "{{chosen_sem}}";
        </script>
        {% else %}
        <script type="text/javascript">
          document.getElementById('sem').value = "{{sem}}";
        </script>
        {% endif %}

        <input type="submit" value="Load" class="btn btn-secondary" />
    </form>
</div>

<br>

    <table class="table table-inbox table-hover" style="font-size:12px; width:100%;">
        <tr>
            <th></th>
            <th>group</th>
            <th>posts</th>
            <th>most recent</th>
            <th>누적 공부 시간(분)</th>
            <th></th>
        </tr>
    {% for user in list %}
        {% if not user.is_staff %}
        <tr>
            <td>
                {{ forloop.counter }}
            </td>
            <td>
                <a href="{% url 'list' user.username %}">
                {% if user.num_posts > 9 %}
                <font color="green">
                {{ user.username }}
                </font>
                {% else %}
                {{ user.username }}
                {% endif %}
                </a>
            </td>
            <td>{{ user.num_posts }}</td>
            <td>{{ user.recent }}</td>
            <td>{{ user.total_dur }}</td>
            <td><a class="confirm-delete" href="{% url 'confirm_delete_user' user.pk %}">유저삭제</a></td>
        {% endif %}
    {% endfor %}
    </table>
</div>

<script>
    $(document).on('click', '.confirm-delete', function(){
    return confirm('유저를 삭제하시겠습니까?');
    })
</script>

{% endblock %}
